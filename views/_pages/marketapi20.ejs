<%- contentFor('HeaderCss') %>

<!--Echart  -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/4.8.0/echarts-en.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>

<!--Datatables  -->
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.flash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.print.min.js"></script>

<script src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap4.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.bootstrap4.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.colVis.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css" />
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap4.min.css" />

<!-- perticular page css -->

<%- contentFor('title') %>  
<title>Hoa Than Son</title>

<%- contentFor('breadcrumb') %>
<div class="col-sm-6">
    <div class="page-title-box">
        <h4 class="font-size-18">Market Information</h4>
        <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item active">Welcome to HTS Market Information</li>
        </ol>
    </div>
</div>

<%- contentFor('body') %>

<div class="row" id="tables">
    <div class="col-12 ">
        <table border="0" cellspacing="5" cellpadding="5">
            <tbody><tr>
                <td>Minimum ATV(5):</td>
                <td><input type="text" id="min" name="min"></td>

                <td>Maximum ATV(5):</td>
                <td><input type="text" id="max" name="max"></td>
            </tr>
            <tr></tr>
        </tbody></table>
        <table class="table table-bordered table-sm mb-0 text-center table-striped" id="example" style="width:100%">
            <thead>
                                  <th>Ticker</th>
                                  <th>ATV(5)</th>
                                  
                                  <th>CVx2 signal</th>
                                  <th>CVx2 from</th>
                                  <th>ATV</th>
                                  <th>MCDX signal</th>
                                  <th>MCDX from</th>
                                  <th>Red-PC</th>
                                  <th>Red(10)</th>
                                  <th>VIX signal</th>
                                  <th>VIX from</th>
                                  <th>VIX</th>
                                  <th>VIX Max</th>
                                  <th>VIX Min</th>
                                  <th>VIX diff</th>
                                  <th>Total(5d)</th>
                                  <th>Status</th>
            </thead>
                   
            <tbody></tbody>
        </table>
    </div>
</div>
<script>
$.fn.dataTable.ext.search.push(
    function( settings, data, dataIndex ) {
        let min = parseInt( $('#min').val(), 10 );
        let max = parseInt( $('#max').val(), 10 );
        let ATV5 = parseFloat( data[1] ) || 0; // use data for the age column
 
        if ( ( isNaN( min ) && isNaN( max ) ) ||
             ( isNaN( min ) && ATV5 <= max ) ||
             ( min <= ATV5   && isNaN( max ) ) ||
             ( min <= ATV5   && ATV5 <= max ) )
        {
            return true;
        }
        return false;
    }
);      
      let data1 = <%- JSON.stringify(result || null) %>;

      let table = $("#example").DataTable({
  order: [[ 15, "desc" ]],
  processing: true,
  serverSide: false,
  autoWidth: true,
  lengthChange: false,
  pageLength: 15,

  dom: 'B<"clear">lfrtip',
  buttons: ['copy', 'csv', 'excel', 'pdf', 'print'],  
  data: data1,
    columns: [
    { data: 'TICKER' ,render: function(data) {return '<a href="/summary?ticker='+data+'" target="_blank">'+data+'</a>'; }},
    { data: 'CV5' , render: function ( data ) { return (data/10).toFixed(2);} },
    
    { data: 'CVSIG' ,render: function(data) {
        if (data>0) {return '<span class="badge badge-success">YES</span>';} else {return '<span class="badge badge-danger"> NO </span>'} } },                 
    { data: 'CVBAR' },
    { data: 'CV' , render: function ( data ) { return (data/10).toFixed(2);} },
    { data: 'MCDXSIG' ,render: function(data) {
        if (data>0) {return '<span class="badge badge-success">YES</span>';} else {return '<span class="badge badge-danger"> NO </span>'} } },                 
    { data: 'MCDXBAR' },
    { data: 'PC' , render: function (data){ return (+data/100).toFixed(2);} },
    { data: 'PC10' , render: function (data){ return (+data/100).toFixed(2);} },
    { data: 'VIXSIG' ,render: function(data) {
        if (data>0) {return '<span class="badge badge-success">YES</span>';} else {return '<span class="badge badge-danger"> NO </span>'} } },                 
    { data: 'VIXBAR' },
    { data: 'VIX' , render: function (data){ return (+data/100).toFixed(2);} },
    { data: 'VIXH52W' , render: function (data){ return (+data/100).toFixed(2);} },
    { data: 'VIXL52W' , render: function (data){ return (+data/100).toFixed(2);} },
    { data: 'vixdiff' , render: function (data){ return (+data/100).toFixed(2);} },

    { data: 'TOTALSIG' ,render: function(data) {
        if (data>0) {return '<p class="mb-0 text-success">'+data+'</p>';} else {return data} } },
    { data: 'STATUS' ,
        render: function(data) {
                         switch (data) {
                            case 'LONG':
                            return '<span class="badge badge-success"> LONG </span>' ;
                                break;
                            case 'SHORT':
                            return '<span class="badge badge-danger">SHORT</span>' ;
                                break;
                            case 'HOLDL':
                            return '<span class="badge badge-warning">HOLD</span> <span class="badge badge-success"> L </span>' ;
                                break;
                            case 'HOLDS':
                            return '<span class="badge badge-warning">HOLD</span> <span class="badge badge-danger"> S </span>' ;
                                break;
                    
                        }

                }
        },        
      ]
});

$('#min, #max').keyup( function() {
        table.draw();
    } );
</script>     

    
<!-- end row -->

<%- contentFor('FooterJs') %>
    <!-- Peity chart-->
    <script src="public/libs/peity/jquery.peity.min.js"></script>

    <!-- Plugin Js-->

    <!--script src="public/js/pages/dashboard.init.js"></script-->

 <%- contentFor('BottomJs') %>
 <!-- nothing -->




